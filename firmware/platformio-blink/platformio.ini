[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 460800
upload_port = /dev/cu.usbserial-21440
monitor_port = /dev/cu.usbserial-21440
build_flags =
  -DCORE_DEBUG_LEVEL=3
  -DUSE_WIFI
  -DLED_PIN=2
  -DUSE_OLED
  -DOLED_ADDR=0x3C
  -DOLED_WIDTH=128
  -DOLED_HEIGHT=64
  -DUSE_WIFI_NVS
  -DALLOW_WIFI_PROVISION
  -DUSE_ASYNC_WEB
  -DUSE_BLE_ADV
  -DFIND_I2C
  -DUSE_I2C_LED
  -DI2C_LED_ADDR=0x70
  -DCONFIG_BT_NIMBLE_ROLE_BROADCASTER=1
  -DCONFIG_BT_NIMBLE_ROLE_OBSERVER=1
  -DCONFIG_BT_NIMBLE_ROLE_PERIPHERAL=1
  -DCONFIG_BT_NIMBLE_ROLE_CENTRAL=1
  -DCONFIG_BT_NIMBLE_MAX_CONNECTIONS=1
  -DCONFIG_BT_NIMBLE_EXT_ADV=0
  -DCONFIG_BT_NIMBLE_MESH=0
  -DCONFIG_BT_NIMBLE_SVC_GAP_DEVICE_NAME_MAX_LEN=20
  -DCONFIG_BT_NIMBLE_GAP_DEVICE_NAME="ESP32"
lib_deps =
  adafruit/Adafruit SSD1306 @ ^2.5.9
  adafruit/Adafruit GFX Library @ ^1.11.9
  adafruit/Adafruit LED Backpack Library @ ^1.5.1
  esphome/ESPAsyncWebServer-esphome @ ^3.4.0
  esp32async/AsyncTCP @ ^3.4.8
  h2zero/NimBLE-Arduino @ ^2.0.0
lib_ignore =
  AsyncTCP-esphome
extra_scripts = pre:scripts/gen_secrets.py

; To enable onboard LED auto-scan add:
; build_flags = ${env:esp32dev.build_flags} -DFIND_LED
; To enable OLED support (address 0x3C default):
; build_flags = ${env:esp32dev.build_flags} -DUSE_OLED -DOLED_ADDR=0x3C -DOLED_WIDTH=128 -DOLED_HEIGHT=64
; To enable WiFi connect (credentials via env vars WIFI_SSID/WIFI_PASS):
; build_flags = ${env:esp32dev.build_flags} -DUSE_WIFI
; To enable async web server + JSON API:
; build_flags = ${env:esp32dev.build_flags} -DUSE_ASYNC_WEB
; To enable BLE advertising:
; build_flags = ${env:esp32dev.build_flags} -DUSE_BLE_ADV -DBLE_ADV_NAME=\"ESP32Blink\"

; Optional: automatically open the serial monitor after upload from CLI:
; monitor_filters = esp32_exception_decoder, default
